<!-- This file contains only the content for the Color Generator tool. -->
<!-- It will be loaded into the main index.html file. -->

<!-- Styles specific to this tool -->
<style>
    .color-card-container {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
        gap: 1.5rem;
    }
    input:disabled {
        background-color: #e2e8f0;
        cursor: not-allowed;
    }
    .feedback-anim { animation: fadeAndScale 1s ease-out forwards; }
    @keyframes fadeAndScale {
        0% { opacity: 1; transform: translate(-50%, -50%) scale(0.8); }
        100% { opacity: 0; transform: translate(-50%, -50%) scale(1.2); }
    }
    .panel-fade-in { animation: fadeIn 0.5s ease-in-out; }
    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
    }
</style>

<!-- Main container for the tool -->
<div class="container mx-auto px-4 py-8 md:py-12">
    <header class="text-center mb-8 md:mb-12">
        <h1 class="text-4xl md:text-5xl font-bold text-slate-900">Advanced Color Palette Generator</h1>
        <p class="mt-3 text-lg text-slate-600 max-w-3xl mx-auto">Select a colormap, generate a palette, and click a color to see its variations.</p>
    </header>

    <!-- Controls -->
    <div class="bg-white p-6 rounded-2xl shadow-lg mb-8 md:mb-12">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
                <label for="colormap-select" class="block text-sm font-medium text-slate-700 mb-2">Colormap</label>
                <select id="colormap-select" class="w-full p-3 bg-slate-50 border border-slate-300 rounded-lg"></select>
            </div>
            <div>
                <label for="color-count" class="block text-sm font-medium text-slate-700 mb-2">Number of Colors (2-256)</label>
                <input type="number" id="color-count" value="16" min="2" max="256" class="w-full p-3 bg-slate-50 border border-slate-300 rounded-lg">
            </div>
        </div>
    </div>

    <!-- Color Palette Display -->
    <main id="palette-display" class="color-card-container"></main>

    <!-- Shade Details Panel Container -->
    <div id="shade-panel-container" class="mt-12"></div>
</div>

<!-- Script dependencies for this tool -->
<script src="https://d3js.org/d3.v7.min.js"></script>
<!-- The main logic for the color generator -->
<script>
    (function initColorGenerator() {
        // All the JavaScript logic from the original file for the color generator goes here.
        const colorSchemes = {
            'Sequential (Multi-Hue)': ['interpolateViridis', 'interpolatePlasma', 'interpolateInferno', 'interpolateMagma', 'interpolateCividis', 'interpolateTurbo', 'interpolateWarm', 'interpolateCool'],
            'Sequential (Single Hue)': ['interpolateBlues', 'interpolateGreens', 'interpolateGreys', 'interpolateOranges', 'interpolatePurples', 'interpolateReds'],
            'Diverging': ['interpolateBrBG', 'interpolatePRGn', 'interpolatePiYG', 'interpolatePuOr', 'interpolateRdBu', 'interpolateRdGy', 'interpolateRdYlBu', 'interpolateRdYlGn', 'interpolateSpectral'],
            'Cyclical': ['interpolateRainbow', 'interpolateSinebow'],
            'Categorical': ['schemeAccent', 'schemeDark2', 'schemePaired', 'schemePastel1', 'schemePastel2', 'schemeSet1', 'schemeSet2', 'schemeSet3', 'schemeTableau10']
        };

        const colormapSelect = document.getElementById('colormap-select');
        const colorCountInput = document.getElementById('color-count');
        const paletteDisplay = document.getElementById('palette-display');
        const shadePanelContainer = document.getElementById('shade-panel-container');
        let activeColorCard = null;

        function generatePalette() {
            const selectedSchemeName = colormapSelect.value;
            let palette = [];

            if (selectedSchemeName.startsWith('scheme')) {
                colorCountInput.disabled = true;
                const scheme = d3[selectedSchemeName];
                palette = scheme.map(c => d3.color(c).formatHex());
                colorCountInput.value = palette.length;
            } else {
                colorCountInput.disabled = false;
                const colorCount = parseInt(colorCountInput.value, 10);
                const interpolator = d3[selectedSchemeName];
                for (let i = 0; i < colorCount; i++) {
                    palette.push(d3.color(interpolator(i / (colorCount - 1))).formatHex());
                }
            }
            return palette;
        }

        function updateDisplay() {
            const palette = generatePalette();
            paletteDisplay.innerHTML = '';
            shadePanelContainer.innerHTML = '';
            activeColorCard = null;

            palette.forEach(hex => {
                const colorCard = document.createElement('div');
                colorCard.className = 'relative group cursor-pointer transform hover:-translate-y-1 transition-transform duration-300 rounded-lg';
                colorCard.dataset.color = hex;
                colorCard.innerHTML = `
                    <div style="background-color: ${hex};" class="w-full h-24 rounded-t-lg shadow-md"></div>
                    <div class="p-3 bg-white rounded-b-lg shadow-md">
                        <p class="font-mono text-sm text-slate-700 font-medium">${hex}</p>
                    </div>
                `;
                colorCard.addEventListener('click', () => {
                    copyToClipboard(hex, colorCard.querySelector('div[style]'));
                    showShadePanel(hex, colorCard);
                });
                paletteDisplay.appendChild(colorCard);
            });
        }

        function generateShades(baseHex) {
            const baseColor = d3.hsl(baseHex);
            const variations = { tints: [], tones: [], shades: [] };
            for (let i = 1; i <= 5; i++) {
                variations.tints.push(baseColor.brighter(i * 0.35).formatHex());
                variations.shades.push(baseColor.darker(i * 0.35).formatHex());
                variations.tones.push(d3.hsl(baseColor.h, baseColor.s * (1 - (i * 0.18)), baseColor.l).formatHex());
            }
            return variations;
        }

        function showShadePanel(hex, cardElement) {
             if (activeColorCard) {
                activeColorCard.classList.remove('ring-2', 'ring-offset-2', 'ring-indigo-500');
            }
            cardElement.classList.add('ring-2', 'ring-offset-2', 'ring-indigo-500');
            activeColorCard = cardElement;
            // ... (rest of the shade panel logic)
        }
        
        function copyToClipboard(text, element) {
            navigator.clipboard.writeText(text);
            // ... (feedback animation logic)
        }

        function init() {
            for (const groupName in colorSchemes) {
                const optgroup = document.createElement('optgroup');
                optgroup.label = groupName;
                colorSchemes[groupName].forEach(name => {
                    const option = document.createElement('option');
                    option.value = name;
                    option.textContent = name.replace(/^(interpolate|scheme)/, '').replace(/([A-Z])/g, ' $1').trim();
                    optgroup.appendChild(option);
                });
                colormapSelect.appendChild(optgroup);
            }
            colormapSelect.addEventListener('change', updateDisplay);
            colorCountInput.addEventListener('input', () => setTimeout(updateDisplay, 300));
            updateDisplay();
        }

        init();
    })();
</script>
